
# TransGeneSelector: A Deep Learning Algorithm for Small Sample Gene Mining

TransGeneSelector is a specialized deep learning algorithm designed for key gene mining in small sample datasets. This tool utilizes a deep learning model to explore and identify crucial genes within a given dataset, as described in the associated paper.

## Getting Started

Follow the steps below to use TransGeneSelector for key gene mining on given dataset in the paper.

### Data Preparation

Before running the algorithm, please prepare your data files according to the following format:

1. Training data file (`merge.csv`):
   - First column: Gene names
   - First row: Labels (0 or 1)
   - Remaining cells: Gene expression values in TPM (Transcripts Per Million)
   - Example format:
     ```
     Label   0        1        0        ...
     Gene1   1.234    2.345    3.456    ...
     Gene2   2.345    3.456    4.567    ...
     ```

2. Test data file (`test_merge.csv`):
   - Should follow the same format as the training data file
   - Must contain the same genes as in the training data
   - Expression values should also be in TPM

Note: You can use your own data by following this format. Simply replace the default data files with your own, ensuring they maintain the same structure with gene names in the first column, binary labels (0 or 1) in the first row, and TPM expression values in the remaining cells.

### Step 1: Run WGAN-GP Transformer
- Execute the `wgan_gp_transformer.py` file with default parameters.
- Inside this file, you can set relevant parameters as per your requirements.
- This will generate a result file named `result.csv`.
- If you do not use the sample filter, a `result_non_classif.csv` file will be generated instead.

### Step 2: Model Saving
- The models for each fold under each fake sample quantity will be automatically saved in the `models` folder.

### Step 3: Model Output Calculation on test set
- Run `model_output_caculation.py` to calculate the output of each generated model on the test set.
- This will generate `output_result.csv` (model output) and `output_indexes.csv` (model performance metrics).

### Step 4: ROC Curve and Metrics on test set
- Execute `roc_curve.py` to plot the ROC curve and calculate metrics such as AUC based on the results in `output_result.csv`.
- This will also generate a result file named `output_five_index.csv`.

### Step 5: Key Gene Mining with SHAP
- Run `shap_test.py` and specify a particular model file to perform key gene mining.
- This will generate a file named `important_genes_by_shap.csv`.

### Step 6: Evaluate Generated Samples with UMAP
- Execute `wgan_sample_evaluation.py` to assess the quality of the samples generated by WGAN using UMAP.

### Step 7: Draw Figures for Model Performance
- Navigate to the `figure_drawing` folder.
- `indexes_line_plot.py` will Utilize `result.csv` and `result_non_classif.csv` to illustrate the performance of the model on the validation set under various fake sample conditions.

## Prerequisites

Ensure you have the following dependencies installed:

- Python 3.8 or later version
- Additional packages specified within each `.py` file

## Contact

Kerui Huang - [huangkerui@huas.edu.cn]


